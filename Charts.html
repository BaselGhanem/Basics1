<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X Academy - Master Class</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: false,
            theme: {
                extend: {
                    colors: {
                        'x-primary': '#107c41',
                        'x-primary-dark': '#0b5c30',
                        'x-secondary': '#fbbf24',
                        'x-light': '#f0fdf4',
                        'gold': '#FFD700',
                        'silver': '#C0C0C0',
                        'bronze': '#CD7F32'
                    },
                    fontFamily: { sans: ['Tajawal', 'ui-sans-serif', 'system-ui'] },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'shake': 'shake 0.5s cubic-bezier(.36,.07,.19,.97) both',
                        'bounce-short': 'bounceShort 0.5s ease-in-out 1',
                        'pulse-glow': 'pulseGlow 2s infinite',
                        'float': 'float 3s ease-in-out infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'slide-in-right': 'slideInRight 0.5s ease-out',
                        'slide-in-left': 'slideInLeft 0.5s ease-out',
                        'zoom-in': 'zoomIn 0.3s ease-out',
                        'tada': 'tada 1s ease-out'
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        shake: { '10%, 90%': { transform: 'translate3d(-1px, 0, 0)' }, '20%, 80%': { transform: 'translate3d(2px, 0, 0)' }, '30%, 50%, 70%': { transform: 'translate3d(-4px, 0, 0)' }, '40%, 60%': { transform: 'translate3d(4px, 0, 0)' } },
                        bounceShort: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
                        pulseGlow: { '0%, 100%': { opacity: '1', boxShadow: '0 0 5px rgba(16, 124, 65, 0.5)' }, '50%': { opacity: '0.8', boxShadow: '0 0 20px rgba(16, 124, 65, 0.8)' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
                        slideInRight: { '0%': { transform: 'translateX(30px)', opacity: '0' }, '100%': { transform: 'translateX(0)', opacity: '1' } },
                        slideInLeft: { '0%': { transform: 'translateX(-30px)', opacity: '0' }, '100%': { transform: 'translateX(0)', opacity: '1' } },
                        zoomIn: { '0%': { transform: 'scale(0.9)', opacity: '0' }, '100%': { transform: 'scale(1)', opacity: '1' } },
                        tada: { '0%': { transform: 'scale(1)' }, '10%, 20%': { transform: 'scale(0.9) rotate(-3deg)' }, '30%, 50%, 70%, 90%': { transform: 'scale(1.1) rotate(3deg)' }, '40%, 60%, 80%': { transform: 'scale(1.1) rotate(-3deg)' }, '100%': { transform: 'scale(1) rotate(0)' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Tajawal', sans-serif; 
            scroll-behavior: smooth;
            background: linear-gradient(135deg, #f0fdf4 0%, #e8f5e9 100%);
            min-height: 100vh;
        }
        .active-link { 
            background-color: #107c41 !important; 
            color: white !important; 
            border-right: 4px solid #fbbf24;
            box-shadow: 0 4px 12px rgba(16, 124, 65, 0.3);
        }
        html[dir="ltr"] .active-link { border-right: none; border-left: 4px solid #fbbf24; }
        .option-btn:hover { transform: scale(1.02); }
        .modal-overlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.85); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 9999; 
            animation: fadeIn 0.3s;
        }
        #toast-container { 
            position: fixed; 
            top: 20px; 
            left: 50%; 
            transform: translateX(-50%); 
            z-index: 100; 
            pointer-events: none; 
        }
        .toast { 
            background: white; 
            padding: 12px 24px; 
            border-radius: 50px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.15); 
            opacity: 0; 
            transform: translateY(-20px); 
            transition: 0.4s; 
            font-weight: bold; 
            display: flex; 
            gap: 10px; 
            align-items: center; 
            border: 1px solid #e5e7eb;
        }
        .toast.show { opacity: 1; transform: translateY(0); }
        .toast.success { border-left: 5px solid #107c41; }
        .toast.error { border-left: 5px solid #ef4444; }
        .excel-grid { border-collapse: collapse; width: 100%; font-family: sans-serif; font-size: 0.8rem; }
        .excel-grid td, .excel-grid th { border: 1px solid #d1d5db; padding: 4px 8px; text-align: center; }
        .excel-header { background-color: #f3f4f6; font-weight: bold; color: #374151; }
        .sheet-tab { padding: 4px 12px; border-radius: 4px 4px 0 0; background: #e5e7eb; color: #6b7280; margin-left: 2px; font-size: 0.75rem; font-weight: 500; }
        .sheet-tab.active-multi { background: white; color: #107c41; border-top: 2px solid #107c41; }
        .progress-ring__circle { transition: stroke-dashoffset 0.5s ease-in-out; transform: rotate(-90deg); transform-origin: 50% 50%; }
        .chart-hover { transition: transform 0.3s ease; }
        .chart-hover:hover { transform: scale(1.05); }
        .badge { animation: pulseGlow 2s infinite; }
        .rank-1 { background: linear-gradient(135deg, #FFD700, #FFEC8B); color: #000; }
        .rank-2 { background: linear-gradient(135deg, #C0C0C0, #E8E8E8); color: #000; }
        .rank-3 { background: linear-gradient(135deg, #CD7F32, #E6B887); color: #000; }
        .sparkline { height: 20px; background: linear-gradient(90deg, #107c41, #fbbf24); border-radius: 10px; margin: 5px 0; }
        
        /* Ø´Ù‡Ø§Ø¯Ø© Ù…Ø­Ø¯Ø¯Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
        #certificate-content {
            background: white !important;
            color: #1f2937 !important;
            border: 8px double #107c41 !important;
        }
        #certificate-content * {
            color: #1f2937 !important;
        }
        #certificate-content img {
            filter: none !important;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="name-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content bg-white p-10 rounded-2xl max-w-lg w-full text-center shadow-2xl animate-zoom-in">
            <img src="https://raw.githubusercontent.com/BaselGhanem/Basics1/refs/heads/main/X%20Academy%20white.png" class="h-24 mx-auto mb-4 animate-float">
            <h2 id="modal-title" class="text-3xl font-black mb-2"></h2>
            <p id="modal-desc" class="text-gray-600 mb-6"></p>
            <form id="name-form" class="space-y-4">
                <input type="text" id="user-name" class="w-full p-4 rounded-xl border-2 bg-transparent text-center text-lg focus:border-x-primary outline-none border-gray-300 animate-pulse-glow" required autofocus>
                <button type="submit" id="modal-btn" class="w-full bg-x-primary hover:bg-x-primary-dark text-white font-bold py-4 rounded-xl transition shadow-lg hover:scale-105"></button>
            </form>
        </div>
    </div>

    <div id="toast-container"></div>

    <header class="sticky top-0 z-40 bg-white/95 backdrop-blur shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <a href="#" onclick="renderContent('hero')" class="flex items-center gap-2 hover:scale-105 transition">
                <img src="https://raw.githubusercontent.com/BaselGhanem/Basics1/refs/heads/main/X%20Academy%20white.png" class="h-12 animate-tada">
            </a>
            <div class="flex items-center gap-4">
                <span id="header-username" class="hidden md:block font-bold text-sm text-x-primary badge px-3 py-1 rounded-full bg-green-50"></span>
                <button onclick="toggleLanguage()" class="px-3 py-1 rounded-lg border border-gray-300 hover:bg-gray-100 text-sm font-bold flex gap-2 transition hover:scale-105">
                    <i data-lucide="languages" class="w-4 h-4"></i> <span id="lang-text">EN</span>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto flex flex-col lg:flex-row p-4 gap-6 mt-2 flex-grow w-full">
        <aside class="w-full lg:w-72 bg-white p-5 rounded-2xl shadow-lg border border-gray-100 h-fit lg:sticky lg:top-24 max-h-[85vh] overflow-y-auto animate-slide-in-right">
            <div class="mb-6 text-center">
                <div class="inline-block relative">
                    <svg class="w-24 h-24 transform -rotate-90">
                        <circle cx="48" cy="48" r="45" fill="none" stroke="#e5e7eb" stroke-width="6"/>
                        <circle id="progress-circle" cx="48" cy="48" r="45" fill="none" stroke="url(#progress-gradient)" stroke-width="6" stroke-dasharray="283" stroke-dashoffset="283" class="progress-ring__circle"/>
                        <defs>
                            <linearGradient id="progress-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#107c41" />
                                <stop offset="100%" stop-color="#fbbf24" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <span id="progress-text" class="absolute inset-0 flex items-center justify-center font-bold text-xl">0%</span>
                </div>
                <p id="progress-label" class="text-sm font-medium mt-2 text-gray-500"></p>
                <div id="xp-display" class="text-xs text-gray-400 mt-1 hidden">XP: <span id="xp-value">0</span></div>
            </div>
            <nav id="lesson-nav" class="space-y-2"></nav>
            <div id="achievements-section" class="mt-6 pt-6 border-t border-gray-200 hidden">
                <h3 class="font-bold text-sm mb-2 text-x-primary flex items-center gap-2"><i data-lucide="award"></i> Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h3>
                <div id="achievements-list" class="space-y-2"></div>
            </div>
        </aside>

        <section id="content-container" class="flex-grow bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-gray-100 min-h-[70vh] animate-slide-in-left"></section>
    </main>

    <!-- Ø´Ù‡Ø§Ø¯Ø© Ø«Ø§Ø¨ØªØ© Ø§Ù„Ø£Ù„ÙˆØ§Ù† -->
    <div id="certificate-modal" style="display: none;" class="modal-overlay">
        <div id="certificate-content" class="bg-white p-10 rounded-xl max-w-3xl w-full text-center relative border-8 border-double border-x-primary shadow-2xl animate-zoom-in" style="background: white !important; color: #1f2937 !important;">
            <button onclick="document.getElementById('certificate-modal').style.display = 'none'" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 transition hover:scale-125" data-html2canvas-ignore="true"><i data-lucide="x-circle" class="w-8 h-8"></i></button>
            <div class="mb-8 flex justify-center">
                 <img src="https://raw.githubusercontent.com/BaselGhanem/Basics1/refs/heads/main/X%20Academy%20white.png" class="h-28 animate-float">
            </div>
            <h2 id="cert-header" class="text-4xl font-bold text-x-primary mb-2"></h2>
            <p id="cert-sub" class="text-xl text-gray-600"></p>
            <h1 id="cert-name" class="text-5xl font-black text-gray-800 my-6 border-b-2 border-x-secondary inline-block pb-2 px-10"></h1>
            <p id="cert-desc" class="text-lg text-gray-600"></p>
            <div class="flex justify-center gap-4 my-6">
                <div class="text-center">
                    <div class="w-12 h-12 rounded-full bg-x-primary text-white flex items-center justify-center mx-auto mb-2"><i data-lucide="sheet"></i></div>
                    <p class="text-sm">4 ØªÙ‚Ù†ÙŠØ§Øª Excel</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 rounded-full bg-teal-500 text-white flex items-center justify-center mx-auto mb-2"><i data-lucide="bar-chart-3"></i></div>
                    <p class="text-sm">8 Ø£Ù†ÙˆØ§Ø¹ Charts</p>
                </div>
            </div>
            <p class="text-sm text-gray-400 mt-8 font-mono">Date: <span id="cert-date"></span></p>
            <div class="flex gap-4 justify-center mt-8" data-html2canvas-ignore="true">
                <button onclick="downloadCertificate()" class="bg-x-primary hover:bg-x-primary-dark text-white font-bold py-3 px-8 rounded-xl flex items-center justify-center gap-2 transition hover:scale-105">
                    <i data-lucide="download"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
                </button>
                <button onclick="shareCertificate()" class="bg-x-secondary hover:bg-yellow-500 text-gray-900 font-bold py-3 px-8 rounded-xl flex items-center justify-center gap-2 transition hover:scale-105">
                    <i data-lucide="share-2"></i> Ù…Ø´Ø§Ø±ÙƒØ©
                </button>
            </div>
        </div>
    </div>

    <div id="leaderboard-modal" style="display: none;" class="modal-overlay">
        <div class="bg-white p-8 rounded-2xl max-w-md w-full shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-x-primary flex items-center gap-2"><i data-lucide="trophy"></i> Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</h3>
                <button onclick="document.getElementById('leaderboard-modal').style.display = 'none'" class="text-gray-400 hover:text-red-500"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <div id="leaderboard-list" class="space-y-3">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            <div class="mt-6 pt-6 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="font-bold">Ø±ØªØ¨ØªÙƒ</p>
                        <p id="user-rank" class="text-2xl font-black text-x-primary">-</p>
                    </div>
                    <div id="user-score" class="text-right">
                        <p class="font-bold">Ù†Ù‚Ø§Ø·Ùƒ</p>
                        <p class="text-2xl font-black text-x-secondary">0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const appState = { 
            lang: 'ar', 
            currentSection: 'hero', 
            completedSections: new Set(), 
            userName: null, 
            tempSelection: null,
            xp: 0,
            achievements: new Set(),
            streak: 0,
            lastActivity: null,
            lessonCompletedMessages: new Set() // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„ØªÙŠ Ø¸Ù‡Ø±Øª Ù„Ù‡Ø§ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
        };

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
        const t = {
            ar: {
                modal: { t: 'ÙŠØ§ Ù‡Ù„Ø§ Ø¨ÙŠÙƒ!', d: 'Ø³Ø¬Ù„ Ø§Ø³Ù…Ùƒ ÙŠØ§ ØºØ§Ù„ÙŠ Ø¹Ø´Ø§Ù† Ù†Ø¨Ù„Ø´.', p: 'Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ..', b: 'ÙŠÙ„Ø§ Ù†Ø¨Ù„Ø´ ðŸš€' },
                hero: { 
                    title: 'Excel Master Class', 
                    sub: 'Ø±Ø­Ù„Ø© Ø´Ø§Ù…Ù„Ø©: ØªØ¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª + Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©', 
                    welcome: 'ÙŠØ§ Ù‡Ù„Ø§ Ø¨Ù€', 
                    desc: 'ÙÙŠ Ù‡Ø§ÙŠ Ø§Ù„Ø±Ø­Ù„Ø© Ø±Ø­ ØªØªÙ‚Ù† Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù€ Multi-Sheets Grouping ÙˆØ±Ø­ ØªØ­ØªØ±Ù Ø§Ù„Ù€ Charts ÙˆØ§Ù†ÙˆØ§Ø¹Ù‡Ø§ Ø§Ù„Ù€ 8.',
                    btn: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©', 
                    f1: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙØ­Ø§Øª', f1d: 'ØªØ­ÙƒÙ… Ø¨Ù…Ù„Ù ÙƒØ§Ù…Ù„ Ø¨ÙƒØ¨Ø³Ø© Ø²Ø±.', 
                    f2: 'Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©', f2d: 'Ø­ÙˆÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù„Ù‚ØµØµ Ø¨ØµØ±ÙŠØ©.', 
                    f3: 'Ø´Ù‡Ø§Ø¯Ø© Ø´Ø§Ù…Ù„Ø©', f3d: 'Ø§Ø«Ø¨Øª Ù…Ù‡Ø§Ø±ØªÙƒ ÙÙŠ Ø§Ù„Ù…Ø¬Ø§Ù„ÙŠÙ†.',
                    leaderboard: 'Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†',
                    stats: 'Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ'
                },
                nav: { hero: 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', p1: 'Ù‚Ø³Ù… 1: ØªØ¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª', p2: 'Ù‚Ø³Ù… 2: Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©', quiz: 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ' },
                lessons: {
                    'grouping': { 
                        t: 'Ø§Ù„ØªØ­Ø¯ÙŠØ¯ (Ctrl & Select)', 
                        d: 'ØªØ¹Ø¯ÙŠÙ„ 5 Ø´Ù‡ÙˆØ± Ø¨ÙƒØ¨Ø³Ø© ÙˆØ§Ø­Ø¯Ø©.', 
                        p: ['Ctrl + Click Ù„ØªØ­Ø¯ÙŠØ¯ ØµÙØ­Ø§Øª.', 'ØªÙƒØªØ¨ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ù…Ø±Ø©ØŒ Ø¨ØªÙ†ÙƒØªØ¨ Ø¹Ù†Ø¯ Ø§Ù„ÙƒÙ„.', 'Shift + Click Ù„ØªØ­Ø¯ÙŠØ¯ Ù†Ø·Ø§Ù‚ ØµÙØ­Ø§Øª.', 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ ÙŠØ¸Ù‡Ø± Ø¨Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù†.'],
                        s: 'Ø¨Ø¯Ùƒ ØªØ¶ÙŠÙ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù€ 3 Ø´Ù‡ÙˆØ± Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©.', 
                        o: ['Ù†Ø³Ø® ÙˆÙ„ØµÙ‚', 'Ctrl + Grouping', 'ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠØ©'],
                        realExample: 'Ø´Ø±ÙƒØ©: ØªØ¹Ø¯ÙŠÙ„ Ø£Ø³Ø¹Ø§Ø± 50 Ù…Ù†ØªØ¬ ÙÙŠ 12 ÙØ±Ø¹ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©. ØªÙˆÙÙŠØ± Ø§Ù„ÙˆÙ‚Øª: 4 Ø³Ø§Ø¹Ø§Øª â†’ 5 Ø¯Ù‚Ø§Ø¦Ù‚.',
                        extra: 'Ø¬Ø±Ø¨: Ø§Ø¶ØºØ· Ctrl ÙˆØ§Ø®ØªØ± ØµÙØ­Ø§Øª Jan ÙˆFeb ÙˆMar Ù…Ø¹Ø§Ù‹'
                    },
                    'formatting': { 
                        t: 'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ (Select All)', 
                        d: 'ØªÙˆØ­ÙŠØ¯ Ø£Ù„ÙˆØ§Ù† ÙˆØ­Ø¯ÙˆØ¯ 20 ØµÙØ­Ø©.', 
                        p: ['Right Click -> Select All Sheets.', 'Ø£ÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø¨ØªØ¹Ù…Ù„Ù‡ Ø¨Ù†Ø³Ø® Ù„Ù„ÙƒÙ„ ÙÙˆØ±Ø§Ù‹.', 'Format Painter ÙŠØ¹Ù…Ù„ Ù…Ø¹ Grouping.', 'ØªØ¹Ø¯ÙŠÙ„ Column Width Ù„Ù„ÙƒÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©.'],
                        s: 'Ù…Ø¯ÙŠØ±Ùƒ Ø·Ù„Ø¨ ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ¹Ù…Ù„ Borders Ù„Ù„ÙƒÙ„.', 
                        o: ['Select All & Format', 'Macro', 'ÙˆØ§Ø­Ø¯ ÙˆØ§Ø­Ø¯'],
                        realExample: 'Ø¨Ù†Ùƒ: ØªÙˆØ­ÙŠØ¯ ØªÙ‚Ø§Ø±ÙŠØ± 30 ÙØ±Ø¹ Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ®Ø·ÙˆØ· Ù…ÙˆØ­Ø¯Ø©. Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©: +40% ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.',
                        extra: 'ØªÙ„Ù…ÙŠØ­: Ø¨Ø¹Ø¯ Select AllØŒ ØºÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ´ÙˆÙ Ø§Ù„ØªØºÙŠÙŠØ± Ø¨ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª'
                    },
                    'formulas': { 
                        t: 'Ø§Ù„Ø¬Ù…Ø¹ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯', 
                        d: 'Ù…Ø¹Ø§Ø¯Ù„Ø© ÙˆØ­Ø¯Ø© Ø¨ØªØ®ØªØ±Ù‚ Ø§Ù„ØµÙØ­Ø§Øª.', 
                        p: ['Sum(First:Last!Cell)', 'ØªØ¬Ù…Ø¹ Ù†ÙØ³ Ø§Ù„Ø®Ù„ÙŠØ© Ù…Ù† ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù„ÙŠ Ø¨Ø§Ù„Ù†Øµ.', 'ØªØ¹Ù…Ù„ Ù…Ø¹ Average, Max, Min Ø£ÙŠØ¶Ø§Ù‹.', 'Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© ØªØ¸Ù‡Ø± Ø¨ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ.'],
                        s: 'Ø¨ØµÙØ­Ø© SummaryØŒ Ø¨Ø¯Ùƒ Ù…Ø¬Ù…ÙˆØ¹ C18 Ù…Ù† Jan Ù„Ù€ Mar.', 
                        o: ['Jan+Feb+..', 'Sum(Jan:Mar!C18)', 'Consolidate'],
                        realExample: 'Ù…Ø³ØªØ´ÙÙ‰: Ù…ØªØ§Ø¨Ø¹Ø© Ø¥ÙŠØ±Ø§Ø¯Ø§Øª 12 Ø´Ù‡Ø± Ø¨Ù€ Ù…Ø¹Ø§Ø¯Ù„Ø© ÙˆØ­Ø¯Ø©. Ø§Ù„Ø¯Ù‚Ø©: 100% Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡ ÙŠØ¯ÙˆÙŠØ©.',
                        extra: 'Ø§Ø³ØªØ®Ø¯Ù…: =AVERAGE(Jan:Dec!B5) Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø³Ù†ÙˆÙŠØ©'
                    },
                    'safety': { 
                        t: 'ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø£Ù…Ø§Ù†', 
                        d: 'Ø®Ø·Ø± Ø§Ù„Ù†Ø³ÙŠØ§Ù†!', 
                        p: ['Ø¨Ø³ ØªØ®Ù„ØµØŒ Ù„Ø§Ø²Ù… ØªØ¹Ù…Ù„ Ungroup.', 'Ø§Ø°Ø§ Ù†Ø³ÙŠØªØŒ Ø±Ø­ ØªØ®Ø±Ø¨ Ø¯Ø§ØªØ§ Ø¨ØµÙØ­Ø§Øª Ø«Ø§Ù†ÙŠØ©.', 'Ø§Ù„Ù…Ø¤Ø´Ø± ÙŠØ¸Ù‡Ø± Group Mode.', 'ØªÙ†Ø¨ÙŠÙ‡ Excel ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„.'],
                        s: 'Ø®Ù„ØµØª Ø´ØºÙ„ Ø¬Ù…Ø§Ø¹ÙŠ ÙˆØ¨Ø¯Ùƒ ØªØ¹Ø¯Ù„ Ø¨Ø³ Ø¹Ù„Ù‰ Jan.', 
                        o: ['Ø¨Ø¹Ø¯Ù„ ÙÙˆØ±Ø§Ù‹', 'Ungroup First', 'Ø³ÙƒØ± Ø§Ù„Ù…Ù„Ù'],
                        realExample: 'Ø´Ø±ÙƒØ© ØªØ£Ù…ÙŠÙ†: Ø®Ø³Ø§Ø±Ø© 5000 Ø³Ø¬Ù„ Ø¨Ø³Ø¨Ø¨ Ù†Ø³ÙŠØ§Ù† Ungroup. Ø§Ù„ØªØ¹Ù„Ù…: Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØªØ­Ù‚Ù‚ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„.',
                        extra: 'Ø§Ù†ØªØ¨Ù‡: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙŠØ¸Ù‡Ø± [Group] Ø¹Ù†Ø¯ Ø§Ù„ØªØ¬Ù…ÙŠØ¹ - ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø²Ø§Ù„ØªÙ‡'
                    },
                    
                    'comparison': { 
                        t: 'Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø§Øª', 
                        d: 'Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù‚ÙŠÙ… Ø¨ÙŠÙ† ÙØ¦Ø§Øª.', 
                        p: ['Column: Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠØ©.', 'Bar: Ø§Ø°Ø§ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø·ÙˆÙŠÙ„Ø©.', 'Ø§Ø³ØªØ®Ø¯Ù… Ø£Ù„ÙˆØ§Ù† Ù…ØªØ¨Ø§ÙŠÙ†Ø© Ù„Ù„ØªÙ…ÙŠÙŠØ².', 'Ø£Ø¶Ù Data Labels Ù„Ù„ÙˆØ¶ÙˆØ­.'],
                        s: 'Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¨ÙŠØ¹Ø§Øª 3 Ù…Ù†ØªØ¬Ø§Øª (A, B, C) Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø£ÙØ¶Ù„.', 
                        o: ['Column', 'Line', 'Pie'], 
                        dataLabels: ['Ø£', 'Ø¨', 'Ø¬'],
                        realExample: 'Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¨ÙŠØ¹Ø§Øª 10 Ù…Ù†ØªØ¬Ø§Øª Ø´Ù‡Ø±ÙŠØ§Ù‹. Ø§Ù„Ù‚Ø±Ø§Ø±: Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£Ù‚Ù„ Ù…Ø¨ÙŠØ¹Ø§Ù‹.',
                        extra: 'Ù…ØªÙ‚Ø¯Ù…: Ø§Ø³ØªØ®Ø¯Ù… Clustered Column Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ù†ØªØ¬Ø§Øª Ø¹Ø¨Ø± ÙØªØ±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©'
                    },
                    'trends': { 
                        t: 'Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª (Ø§Ù„Ø²Ù…Ù†)', 
                        d: 'ÙƒÙŠÙ Ø§Ù„ÙˆØ¶Ø¹ Ø¨ØªØºÙŠØ± Ù…Ø¹ Ø§Ù„ÙˆÙ‚ØªØŸ', 
                        p: ['Line: Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØµØ¹ÙˆØ¯ ÙˆØ§Ù„Ù‡Ø¨ÙˆØ·.', 'Area: Ù„ØªÙˆØ¶ÙŠØ­ Ø­Ø¬Ù… Ø§Ù„ØªØºÙŠÙŠØ±.', 'Ø£Ø¶Ù Trendline Ù„Ù„ØªÙ†Ø¨Ø¤.', 'Ø§Ø³ØªØ®Ø¯Ù… Markers Ù„Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ù‡Ù…Ø©.'],
                        s: 'Ø³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø¨ Ø¨Ø¢Ø®Ø± 5 Ø´Ù‡ÙˆØ± (Ø§ØªØ¬Ø§Ù‡ Ø¹Ø§Ù…).', 
                        o: ['Pie', 'Bar', 'Line'], 
                        dataLabels: ['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ'],
                        realExample: 'Ø¨ÙˆØ±ØµØ©: ØªØªØ¨Ø¹ Ø³Ù‡Ù… Ø´Ø±ÙƒØ© Ø¹Ù„Ù‰ Ù…Ø¯Ù‰ Ø³Ù†Ø©. Ø§Ù„Ø§ÙƒØªØ´Ø§Ù: Ø§Ø±ØªÙØ§Ø¹ Ù‚ÙˆÙŠ ÙÙŠ Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«.',
                        extra: 'Ø¬Ø±Ø¨: Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ø§Ù„Ø®Ø· Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©'
                    },
                    'proportions': { 
                        t: 'Ø§Ù„Ù†Ø³Ø¨ (Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡)', 
                        d: 'Ø­ØµØ© ÙƒÙ„ ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„ÙƒØ¹ÙƒØ©.', 
                        p: ['Pie: Ù„Ù„Ø£Ø¬Ø²Ø§Ø¡ Ù…Ù† Ø§Ù„ÙƒÙ„ (%).', 'Ù„Ø§ ØªØ³ØªØ®Ø¯Ù…Ù‡Ø§ Ø§Ø°Ø§ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… > 7.', 'Doughnut: Ù†Ø³Ø®Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ù† Pie.', 'Ø§Ø³ØªØ®Ø¯Ù… Explode slice Ù„Ù„ØªØ£ÙƒÙŠØ¯.'],
                        s: 'ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© (50% Ø±ÙˆØ§ØªØ¨ØŒ 30% ØªØ³ÙˆÙŠÙ‚..).', 
                        o: ['Radar', 'Pie', 'Scatter'], 
                        dataLabels: ['Ø±ÙˆØ§ØªØ¨','ØªØ³ÙˆÙŠÙ‚','ØªØ´ØºÙŠÙ„'],
                        realExample: 'Ø´Ø±ÙƒØ© Ù†Ø§Ø´Ø¦Ø©: ØªÙˆØ²ÙŠØ¹ Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…. Ø§Ù„Ø´ÙØ§ÙÙŠØ©: Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø³Ø¨ Ù„Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†.',
                        extra: 'Ø§Ø­ØªØ±Ø§ÙÙŠ: Ø§Ø³ØªØ®Ø¯Ù… Pie of Pie Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©'
                    },
                    'relationships': { 
                        t: 'Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©', 
                        d: 'ØªÙ‚ÙŠÙŠÙ… Ø®ØµØ§Ø¦Øµ Ù…ØªØ¹Ø¯Ø¯Ø©.', 
                        p: ['Radar: Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª (Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª).', 'Scatter: Ù„Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ù…ØªØºÙŠØ±ÙŠÙ†.', 'Bubble: Ø«Ù„Ø§Ø« Ø£Ø¨Ø¹Ø§Ø¯ (X, Y, Size).', 'Heatmap: ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.'],
                        s: 'ØªÙ‚ÙŠÙŠÙ… Ù…ÙˆØ¸Ù Ø¨Ù€ 5 Ù…Ù‡Ø§Ø±Ø§Øª (ØªÙˆØ§ØµÙ„ØŒ ØªÙ‚Ù†ÙŠØ©ØŒ Ø§Ù„ØªØ²Ø§Ù…..).', 
                        o: ['Radar', 'Line', 'Column'], 
                        dataLabels: ['ØªÙˆØ§ØµÙ„','ØªÙ‚Ù†ÙŠØ©','ÙØ±ÙŠÙ‚','ÙˆÙ‚Øª','Ø¹Ù…Ù„'],
                        realExample: 'Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©: Ù…Ù‚Ø§Ø±Ù†Ø© Ø£Ø¯Ø§Ø¡ 50 Ù…ÙˆØ¸Ù Ø¨Ù€ 8 Ù…Ø¹Ø§ÙŠÙŠØ±. Ø§Ù„ØªØ·ÙˆÙŠØ±: ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ù„Ù„ØªØ¯Ø±ÙŠØ¨.',
                        extra: 'ØªÙØ§Ø¹Ù„ÙŠ: Ø­Ø±Ùƒ Ù†Ù‚Ø§Ø· Ø§Ù„Ù€ Scatter Ù„ØªØ±Ù‰ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© ØªØªØºÙŠØ±'
                    }
                },
                excelSim: { 
                    item: 'ØµÙ†Ù', qty: 'ÙƒÙ…ÙŠØ©', sales: 'Ù…Ø¨ÙŠØ¹Ø§Øª', total: 'Ù…Ø¬Ù…ÙˆØ¹', 
                    editWarn: 'ØªÙ†Ø¨ÙŠÙ‡: ØªØ¹Ø¯ÙŠÙ„ Jan ÙÙ‚Ø·', noFormat: 'Ø¨Ø¯ÙˆÙ† ØªÙ†Ø³ÙŠÙ‚ Ù…ÙˆØ­Ø¯', 
                    safe: 'Ø¢Ù…Ù†: Jan ÙÙ‚Ø·', warn: 'Ø®Ø·Ø±: ØªØ¹Ø¯ÙŠÙ„ Ø¬Ù…Ø§Ø¹ÙŠ',
                    multiSelect: 'ØªÙ… ØªØ­Ø¯ÙŠØ¯ ØµÙØ­Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©',
                    groupMode: 'ÙˆØ¶Ø¹ Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ù†Ø´Ø·'
                },
                common: {
                    progress: 'Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²', lesson: 'Ø¯Ø±Ø³', learn: 'Ø´Ùˆ Ø±Ø­ ØªØªØ¹Ù„Ù…ØŸ', task: 'Ø§Ù„ØªØ­Ø¯ÙŠ', taskSub: 'Ø·Ø¨Ù‚ Ø§Ù„Ù„ÙŠ ØªØ¹Ù„Ù…ØªÙ‡', 
                    scenario: 'Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ:', choose: 'Ø§Ù„Ø­Ù„ Ø§Ù„Ø£Ù†Ø³Ø¨:', placeholder: 'Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø±Ø­ ØªØ¸Ù‡Ø± Ù‡ÙˆÙ†..', 
                    check: 'ØªØ­Ù‚Ù‚', next: 'Ø§Ù„ØªØ§Ù„ÙŠ', submit: 'ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
                    correct: 'ÙˆØ­Ø´! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©.', wrong: 'Ø±ÙƒØ² Ø´ÙˆÙŠ.. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©.',
                    cert: { h: 'Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ‚Ø§Ù†', s: 'ØªØ´Ù‡Ø¯ X Academy Ø¨Ø£Ù†', d: 'Ø£ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø­Ø§Ø¶Ø±Ø© Excel & Charts' },
                    realExample: 'Ù…Ø«Ø§Ù„ ÙˆØ§Ù‚Ø¹ÙŠ',
                    extraTip: 'ØªÙ„Ù…ÙŠØ­ Ø¥Ø¶Ø§ÙÙŠ',
                    achievements: {
                        firstBlood: { name: 'Ø§Ù„Ø¶Ø±Ø¨Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰', desc: 'Ø£ÙƒÙ…Ù„ Ø£ÙˆÙ„ Ø¯Ø±Ø³' },
                        excelMaster: { name: 'Ø³Ø§Ø­Ø± Ø§Ù„Ø¥ÙƒØ³Ù„', desc: 'Ø£ÙƒÙ…Ù„ Ù‚Ø³Ù… Excel' },
                        chartWizard: { name: 'Ø³Ø§Ø­Ø± Ø§Ù„Ø±Ø³ÙˆÙ…', desc: 'Ø£ÙƒÙ…Ù„ Ù‚Ø³Ù… Charts' },
                        perfectScore: { name: 'Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', desc: 'Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ 100% ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±' },
                        speedDemon: { name: 'Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø±Ù‚', desc: 'Ø£ÙƒÙ…Ù„ 3 Ø¯Ø±ÙˆØ³ ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† 5 Ø¯Ù‚Ø§Ø¦Ù‚' }
                    }
                },
                quiz: { 
                    t: 'Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„',
                    qs: [
                        {t: 'ÙƒÙŠÙ ØªØ­Ø¯Ø¯ ØµÙØ­Ø§Øª Ù…ØªÙØ±Ù‚Ø©ØŸ', o: ['Shift', 'Ctrl', 'Alt']},
                        {t: 'Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ù„Ø¬Ù…Ø¹ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ØŸ', o: ['Sum(Jan+Feb)', 'Sum(Jan:Mar!A1)', 'Sum(All!A1)']},
                        {t: 'Ø£ÙŠ Ø±Ø³Ù… ÙŠØ³ØªØ®Ø¯Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©ØŸ', o: ['Line', 'Pie', 'Radar']},
                        {t: 'Ø£ÙØ¶Ù„ Ø±Ø³Ù… Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† ÙØ¦Ø§Øª Ø¨Ø£Ø³Ù…Ø§Ø¡ Ø·ÙˆÙŠÙ„Ø©ØŸ', o: ['Bar (Horizontal)', 'Column', 'Scatter']}
                    ]
                }
            },
            en: {
                modal: { t: 'Welcome!', d: 'Enter your name to start.', p: 'Your Name...', b: 'Let\'s Start ðŸš€' },
                hero: { 
                    title: 'Excel Master Class', 
                    sub: 'Comprehensive: Multi-Sheets + Charts', 
                    welcome: 'Welcome', 
                    desc: 'Master Multi-Sheet Grouping logic and visualize data professionally with 8 chart types.',
                    btn: 'Start Course', 
                    f1: 'Sheet Management', f1d: 'Control entire workbook instantly.', 
                    f2: 'Data Viz', f2d: 'Turn numbers into stories.', 
                    f3: 'Certificate', f3d: 'Prove your dual skills.',
                    leaderboard: 'Leaderboard',
                    stats: 'Your Stats'
                },
                nav: { hero: 'Home', p1: 'Part 1: Multi-Sheets', p2: 'Part 2: Charts', quiz: 'Final Quiz' },
                lessons: {
                    'grouping': { 
                        t: 'Grouping (Ctrl)', 
                        d: 'Edit 5 months in one click.', 
                        p: ['Ctrl + Click to select sheets.', 'Write formula once, applies to all.', 'Shift + Click for range.', 'Group mode shows in title bar.'],
                        s: 'You want to SUM sales for 3 months at once.', 
                        o: ['Copy Paste', 'Ctrl + Grouping', 'Manual Type'],
                        realExample: 'Company: Adjust prices of 50 products across 12 branches simultaneously. Time saved: 4 hours â†’ 5 minutes.',
                        extra: 'Try: Hold Ctrl and select Jan, Feb, and Mar together'
                    },
                    'formatting': { 
                        t: 'Select All Sheets', 
                        d: 'Unified format for 20 sheets.', 
                        p: ['Right Click -> Select All Sheets.', 'Formatting replicates instantly.', 'Format Painter works with Grouping.', 'Adjust Column Width for all at once.'],
                        s: 'Manager wants Blue headers & Borders for all agents.', 
                        o: ['Select All & Format', 'Macro', 'One by one'],
                        realExample: 'Bank: Unify reports of 30 branches with consistent colors & fonts. Professionalism: +40% report readability.',
                        extra: 'Tip: After Select All, change background color and watch all sheets update'
                    },
                    'formulas': { 
                        t: '3D Formulas', 
                        d: 'One formula across tabs.', 
                        p: ['Sum(First:Last!Cell)', 'Sums the same cell from all sheets in between.', 'Works with Average, Max, Min too.', 'Merged cells show special format.'],
                        s: 'In Summary sheet, sum C18 from Jan to Mar.', 
                        o: ['Jan+Feb+..', 'Sum(Jan:Mar!C18)', 'Consolidate'],
                        realExample: 'Hospital: Track revenue across 12 months with single formula. Accuracy: 100% no manual errors.',
                        extra: 'Use: =AVERAGE(Jan:Dec!B5) for yearly sales average'
                    },
                    'safety': { 
                        t: 'Safety Warning', 
                        d: 'Don\'t Forget!', 
                        p: ['Always Ungroup when done.', 'If you forget, you overwrite other data.', 'Cursor shows Group Mode.', 'Excel warning appears on edit.'],
                        s: 'Finished grouping, now need to edit Jan ONLY.', 
                        o: ['Edit immediately', 'Ungroup First', 'Close File'],
                        realExample: 'Insurance company: Lost 5000 records due to forgotten Ungroup. Lesson: Always verify before editing.',
                        extra: 'Watch: Title shows [Group] when grouped - make sure to remove it'
                    },
                    
                    'comparison': { 
                        t: 'Comparisons', 
                        d: 'Comparing values across cats.', 
                        p: ['Column: Vertical comparison.', 'Bar: Good for long labels.', 'Use contrasting colors.', 'Add Data Labels for clarity.'],
                        s: 'Compare sales of 3 products (A, B, C).', 
                        o: ['Column', 'Line', 'Pie'], 
                        dataLabels: ['A', 'B', 'C'],
                        realExample: 'E-commerce: Compare monthly sales of 10 products. Decision: Discontinue low-performing products.',
                        extra: 'Advanced: Use Clustered Column to compare products across multiple periods'
                    },
                    'trends': { 
                        t: 'Trends', 
                        d: 'Change over time.', 
                        p: ['Line: See ups and downs.', 'Area: Visualize volume.', 'Add Trendline for prediction.', 'Use Markers for key points.'],
                        s: 'Gold price over last 5 months.', 
                        o: ['Pie', 'Bar', 'Line'], 
                        dataLabels: ['Jan','Feb','Mar','Apr','May'],
                        realExample: 'Stock market: Track company stock over 1 year. Discovery: Strong rise in Q3.',
                        extra: 'Try: Click line points to see detailed values'
                    },
                    'proportions': { 
                        t: 'Proportions', 
                        d: 'Part of a whole.', 
                        p: ['Pie: Percentages.', 'Don\'t use if > 7 slices.', 'Doughnut: Advanced Pie.', 'Use Explode slice for emphasis.'],
                        s: 'Budget Split (50% Salary, 30% Mkt..).', 
                        o: ['Radar', 'Pie', 'Scatter'], 
                        dataLabels: ['Sal','Mkt','Ops'],
                        realExample: 'Startup: Capital distribution across departments. Transparency: Show percentages to investors.',
                        extra: 'Pro: Use Pie of Pie for large groups'
                    },
                    'relationships': { 
                        t: 'Relationships', 
                        d: 'Multiple characteristics.', 
                        p: ['Radar: Skills assessment.', 'Scatter: Correlation.', 'Bubble: Three dimensions (X, Y, Size).', 'Heatmap: Data density.'],
                        s: 'Employee Eval on 5 skills.', 
                        o: ['Radar', 'Line', 'Column'], 
                        dataLabels: ['Comm','Tech','Team','Time','Work'],
                        realExample: 'HR: Compare performance of 50 employees across 8 criteria. Development: Identify weak points for training.',
                        extra: 'Interactive: Drag Scatter points to see relationships change'
                    }
                },
                excelSim: { 
                    item: 'Item', qty: 'Qty', sales: 'Sales', total: 'Total', 
                    editWarn: 'Editing Jan Only!', noFormat: 'No Global Format', 
                    safe: 'Safe: Jan Only', warn: 'Warning: All Sheets Edited!',
                    multiSelect: 'Multiple Sheets Selected',
                    groupMode: 'Group Mode Active'
                },
                common: {
                    progress: 'Progress', lesson: 'Lesson', learn: 'Concepts', task: 'Challenge', taskSub: 'Apply your skills', 
                    scenario: 'Scenario:', choose: 'Best Action:', placeholder: 'Result appears here..', 
                    check: 'Verify', next: 'Next', submit: 'Submit Quiz',
                    correct: 'Correct! Great job.', wrong: 'Incorrect. Try again.',
                    cert: { h: 'Certificate of Mastery', s: 'X Academy Certifies', d: 'Mastered Excel & Charts' },
                    realExample: 'Real World Example',
                    extraTip: 'Extra Tip',
                    achievements: {
                        firstBlood: { name: 'First Blood', desc: 'Complete first lesson' },
                        excelMaster: { name: 'Excel Wizard', desc: 'Complete Excel section' },
                        chartWizard: { name: 'Chart Wizard', desc: 'Complete Charts section' },
                        perfectScore: { name: 'Perfect Score', desc: 'Get 100% on final quiz' },
                        speedDemon: { name: 'Speed Demon', desc: 'Complete 3 lessons in under 5 minutes' }
                    }
                },
                quiz: { 
                    t: 'Comprehensive Final Quiz',
                    qs: [
                        {t: 'How to select non-adjacent sheets?', o: ['Shift', 'Ctrl', 'Alt']},
                        {t: 'Correct 3D Formula?', o: ['Sum(Jan+Feb)', 'Sum(Jan:Mar!A1)', 'Sum(All!A1)']},
                        {t: 'Which chart for percentages?', o: ['Line', 'Pie', 'Radar']},
                        {t: 'Best chart for long category names?', o: ['Bar (Horizontal)', 'Column', 'Scatter']}
                    ]
                }
            }
        };

        const lessonsConfig = {
            'grouping': { type: 'excel', visual: 'grouping', correct: 'opt2', optionsIcons: ['copy', 'layers', 'edit'] },
            'formatting': { type: 'excel', visual: 'formatting', correct: 'opt1', optionsIcons: ['paint-bucket', 'code', 'check'] },
            'formulas': { type: 'excel', visual: '3dsum', correct: 'opt2', optionsIcons: ['plus', 'sigma', 'database'] },
            'safety': { type: 'excel', visual: 'ungroup', correct: 'opt2', optionsIcons: ['edit', 'unlock', 'x'] },
            
            'comparison': { type: 'chart', visual: 'column', correct: 'column', data: {d:[120,190,80]}, optionsIcons: ['bar-chart', 'trending-up', 'pie-chart'], optionIds: ['column', 'line', 'pie'] },
            'trends': { type: 'chart', visual: 'line', correct: 'line', data: {d:[1800,1820,1790,1850,1900]}, optionsIcons: ['pie-chart', 'align-left', 'trending-up'], optionIds: ['pie', 'bar', 'line'] },
            'proportions': { type: 'chart', visual: 'pie', correct: 'pie', data: {d:[50,30,20]}, optionsIcons: ['hexagon', 'pie-chart', 'scatter'], optionIds: ['radar', 'pie', 'scatter'] },
            'relationships': { type: 'chart', visual: 'radar', correct: 'radar', data: {d:[80,90,70,85,60]}, optionsIcons: ['hexagon', 'trending-up', 'bar-chart'], optionIds: ['radar', 'line', 'column'] }
        };

        const chartConfig = { 
            column: {type:'bar'}, 
            bar: {type:'bar', indexAxis:'y'}, 
            line: {type:'line'}, 
            pie: {type:'pie'}, 
            radar: {type:'radar'},
            scatter: {type:'scatter'}
        };

        window.onload = () => {
            updateStaticText();
            showNameModal();
            lucide.createIcons();
	        document.getElementById('cert-date').textContent = new Date().toLocaleDateString('en-GB');
            updateLeaderboard();
        };

        function toggleLanguage() {
            appState.lang = appState.lang === 'ar' ? 'en' : 'ar';
            document.documentElement.lang = appState.lang;
            document.documentElement.dir = appState.lang === 'ar' ? 'rtl' : 'ltr';
            updateStaticText(); 
            renderNav(); 
            renderContent(appState.currentSection);
        }

        function updateStaticText() {
            const T = t[appState.lang];
            document.getElementById('lang-text').textContent = appState.lang === 'ar' ? 'EN' : 'AR';
            
            document.getElementById('modal-title').textContent = T.modal.t;
            document.getElementById('modal-desc').textContent = T.modal.d;
            document.getElementById('user-name').placeholder = T.modal.p;
            document.getElementById('modal-btn').textContent = T.modal.b;

            if(appState.userName) {
                document.getElementById('header-username').textContent = `${T.hero.welcome} ${appState.userName}`;
                document.getElementById('cert-name').textContent = appState.userName;
            }
            document.getElementById('progress-label').textContent = T.common.progress;
            document.getElementById('cert-header').textContent = T.common.cert.h;
            document.getElementById('cert-sub').textContent = T.common.cert.s;
            document.getElementById('cert-desc').innerHTML = T.common.cert.d;
        }

        function showNameModal() {
            document.getElementById('name-modal').style.display = 'flex';
            document.getElementById('name-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('user-name').value.trim();
                if(name) {
                    appState.userName = name;
                    updateStaticText();
                    document.getElementById('name-modal').style.display = 'none';
                    renderNav(); 
                    renderContent('hero');
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø¥Ù†Ø¬Ø§Ø²
                    addAchievement('firstBlood');
                    showToast(`ÙŠØ§ Ù‡Ù„Ø§ ${name}! Ø±Ø­ ØªØªØ¹Ù„Ù… Ø£Ø´ÙŠØ§Ø¡ Ø±Ù‡ÙŠØ¨Ø©`, 'success');
                    
                    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù†Ø§Ø±ÙŠØ©
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 }
                    });
                }
            });
        }

        function renderNav() {
            const T = t[appState.lang].nav;
            const L = t[appState.lang].lessons;
            const nav = document.getElementById('lesson-nav');
            nav.innerHTML = '';
            
            const createBtn = (id, title, icon) => {
                const active = appState.currentSection === id;
                const done = appState.completedSections.has(id);
                const isQuiz = id === 'quiz';
                return `<button onclick="renderContent('${id}')" class="w-full text-start px-4 py-3 rounded-xl mb-1 flex justify-between transition ${active ? 'active-link' : 'hover:bg-gray-50 text-gray-700'} ${isQuiz ? 'border-2 border-x-secondary' : ''}">
                    <span class="flex gap-2 items-center"><i data-lucide="${icon}" class="w-4"></i> ${title}</span>
                    ${done ? '<i data-lucide="check-circle-2" class="w-4 text-excel-green animate-pulse-glow"></i>' : ''}
                </button>`;
            };

            nav.innerHTML += createBtn('hero', T.hero, 'home');
            nav.innerHTML += `<div class="text-xs font-bold text-gray-400 mt-4 mb-2 uppercase px-2">${T.p1}</div>`;
            ['grouping', 'formatting', 'formulas', 'safety'].forEach(k => nav.innerHTML += createBtn(k, L[k].t, 'sheet'));
            nav.innerHTML += `<div class="text-xs font-bold text-gray-400 mt-4 mb-2 uppercase px-2">${T.p2}</div>`;
            ['comparison', 'trends', 'proportions', 'relationships'].forEach(k => nav.innerHTML += createBtn(k, L[k].t, 'bar-chart-2'));
            nav.innerHTML += `<div class="my-2 border-t border-gray-200"></div>`;
            nav.innerHTML += createBtn('quiz', T.quiz, 'award');
            
            updateProgress();
            updateAchievements();
            lucide.createIcons();
        }

        function updateProgress() {
            const pct = Math.round((appState.completedSections.size / 9) * 100);
            const circle = document.getElementById('progress-circle');
            const circumference = 2 * Math.PI * 45;
            const offset = circumference - (pct / 100) * circumference;
            circle.style.strokeDashoffset = offset;
            
            document.getElementById('progress-text').textContent = pct + '%';
            
            // ØªØ­Ø¯ÙŠØ« XP
            const xpElement = document.getElementById('xp-value');
            if (xpElement) {
                appState.xp = appState.completedSections.size * 100;
                xpElement.textContent = appState.xp;
                document.getElementById('xp-display').classList.remove('hidden');
            }
        }

        function updateAchievements() {
            const achievements = [
                { id: 'firstBlood', icon: 'droplet', color: 'bg-red-100 text-red-800' },
                { id: 'excelMaster', icon: 'zap', color: 'bg-green-100 text-green-800' },
                { id: 'chartWizard', icon: 'sparkles', color: 'bg-purple-100 text-purple-800' },
                { id: 'perfectScore', icon: 'target', color: 'bg-yellow-100 text-yellow-800' },
                { id: 'speedDemon', icon: 'bolt', color: 'bg-blue-100 text-blue-800' }
            ];

            const section = document.getElementById('achievements-section');
            const list = document.getElementById('achievements-list');
            
            if (appState.achievements.size > 0) {
                section.classList.remove('hidden');
                list.innerHTML = achievements.map(ach => {
                    if (appState.achievements.has(ach.id)) {
                        const T = t[appState.lang].common.achievements[ach.id];
                        return `
                            <div class="flex items-center gap-2 p-2 rounded-lg ${ach.color} animate-fade-in">
                                <i data-lucide="${ach.icon}" class="w-4 h-4"></i>
                                <div class="text-xs">
                                    <div class="font-bold">${T.name}</div>
                                    <div class="text-xs opacity-75">${T.desc}</div>
                                </div>
                            </div>
                        `;
                    }
                    return '';
                }).join('');
            }
        }

        function addAchievement(id) {
            if (!appState.achievements.has(id)) {
                appState.achievements.add(id);
                const T = t[appState.lang].common.achievements[id];
                showToast(`ðŸŽ‰ Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª Ø¥Ù†Ø¬Ø§Ø²: ${T.name}`, 'success');
                updateAchievements();
            }
        }

        function renderContent(key) {
            appState.currentSection = key; 
            appState.tempSelection = null;
            const container = document.getElementById('content-container');
            container.classList.remove('animate-fade-in');
            
            if(key === 'hero') container.innerHTML = renderHero();
            else if(key === 'quiz') container.innerHTML = renderQuiz();
            else container.innerHTML = renderLesson(key);
            
            void container.offsetWidth; 
            container.classList.add('animate-fade-in');
            renderNav(); 
            lucide.createIcons();
        }

        function renderHero() {
            const T = t[appState.lang].hero;
            return `
                <div class="text-center py-8">
                    <div class="flex justify-center gap-4 mb-6 animate-bounce-short">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center text-excel-green animate-spin-slow">
                            <i data-lucide="sheet" class="w-8 h-8"></i>
                        </div>
                        <div class="w-16 h-16 bg-teal-100 rounded-full flex items-center justify-center text-teal-500 animate-spin-slow" style="animation-delay: 0.5s">
                            <i data-lucide="pie-chart" class="w-8 h-8"></i>
                        </div>
                    </div>
                    <h1 class="text-5xl font-black mb-2 text-gray-800 animate-fade-in">${T.title}</h1>
                    <h2 class="text-2xl text-x-primary font-bold mb-4 animate-fade-in" style="animation-delay: 0.2s">${T.sub}</h2>
                    <p class="text-lg text-gray-600 mb-8 max-w-2xl mx-auto animate-fade-in" style="animation-delay: 0.4s">
                        ${T.welcome} <span class="text-x-primary font-bold badge px-2 py-1 rounded">${appState.userName||''}</span>, ${T.desc}
                    </p>
                    <button onclick="renderContent('grouping')" class="bg-x-primary hover:bg-x-primary-dark text-white font-bold py-3 px-10 rounded-xl shadow-lg transition hover:scale-105 flex items-center justify-center gap-2 mx-auto animate-fade-in" style="animation-delay: 0.6s">
                        ${T.btn} <i data-lucide="${appState.lang==='ar'?'arrow-left':'arrow-right'}"></i>
                    </button>
                    
                    <div class="grid md:grid-cols-3 gap-6 mt-12 text-start animate-fade-in" style="animation-delay: 0.8s">
                        ${[1,2,3].map(i => `
                            <div class="p-6 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200 hover:border-x-primary transition hover:scale-[1.02] hover:shadow-xl">
                                <div class="w-12 h-12 rounded-xl bg-x-primary/10 flex items-center justify-center mb-4">
                                    <i data-lucide="${i===1?'layers':i===2?'bar-chart-3':'award'}" class="w-6 h-6 text-x-primary"></i>
                                </div>
                                <h3 class="font-bold text-gray-800 text-x-primary text-lg mb-2">${T['f'+i]}</h3>
                                <p class="text-sm text-gray-500">${T['f'+i+'d']}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-12 flex gap-4 justify-center">
                        <button onclick="showLeaderboard()" class="px-6 py-3 bg-gradient-to-r from-gold to-yellow-400 text-gray-900 font-bold rounded-xl flex items-center gap-2 hover:scale-105 transition">
                            <i data-lucide="trophy"></i> ${T.leaderboard}
                        </button>
                    </div>
                </div>
            `;
        }

        function renderLesson(key) {
            const T = t[appState.lang].common;
            const L = t[appState.lang].lessons[key];
            const C = lessonsConfig[key];
            const isDone = appState.completedSections.has(key);
            
            const optionsHTML = L.o.map((optText, idx) => {
                const optId = C.type === 'chart' ? C.optionIds[idx] : `opt${idx+1}`;
                const icon = C.optionsIcons[idx];
                const isCorrect = (C.type === 'excel' && `opt${idx+1}` === C.correct) || (C.type === 'chart' && optId === C.correct);
                
                return `
                    <button onclick="selectOption('${key}', '${optId}')" id="btn-${optId}" 
                            class="option-btn w-full flex items-center gap-4 p-4 rounded-xl border border-gray-300 hover:shadow-lg transition bg-white hover:scale-[1.02] 
                                   ${isDone && isCorrect ? 'ring-2 ring-excel-green bg-green-50 animate-pulse-glow' : ''}">
                        <div class="w-12 h-12 rounded-full bg-gradient-to-br from-gray-100 to-gray-50 flex items-center justify-center text-x-primary">
                            <i data-lucide="${icon}" class="w-6 h-6"></i>
                        </div>
                        <div class="flex-1 text-right">
                            <span class="font-bold text-gray-800 text-lg">${optText}</span>
                        </div>
                    </button>
                `;
            }).join('');

            return `
                <div class="space-y-8">
                    <div class="border-b border-gray-200 pb-6">
                        <div class="flex justify-between items-start">
                            <div>
                                <span class="text-x-primary font-bold text-sm uppercase bg-green-50 px-3 py-1 rounded-full">${T.lesson} ${Object.keys(lessonsConfig).indexOf(key) + 1}</span>
                                <h2 class="text-4xl font-extrabold mt-2 text-gray-800">${L.t}</h2>
                                <p class="text-gray-500 mt-2 text-lg">${L.d}</p>
                            </div>
                            <div class="text-right">
                                <div class="text-xs text-gray-400">Ø§Ù„Ù†Ù‚Ø§Ø·</div>
                                <div class="text-2xl font-black text-x-secondary">${isDone ? '100' : '0'}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-8 rounded-2xl border border-blue-100">
                        <h3 class="font-bold text-xl mb-4 text-blue-800 flex gap-3 items-center">
                            <i data-lucide="book-open" class="w-6 h-6"></i> ${T.learn}
                        </h3>
                        <ul class="space-y-3 text-gray-700">
                            ${L.p.map(p => `<li class="flex items-start gap-2"><i data-lucide="check-circle" class="w-5 h-5 text-green-500 mt-1 flex-shrink-0"></i> ${p}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-8 p-8 bg-gradient-to-br from-white to-gray-50 rounded-2xl border-2 border-gray-100 shadow-lg">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-bold text-xl mb-3 text-x-primary flex items-center gap-2">
                                    <i data-lucide="target"></i> ${T.scenario}
                                </h4>
                                <div class="bg-amber-50 p-4 rounded-xl border border-amber-200">
                                    <p class="text-gray-700 text-lg">${L.s}</p>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="font-bold text-lg mb-4 text-gray-800 flex items-center gap-2">
                                    <i data-lucide="lightbulb"></i> ${T.choose}
                                </h4>
                                <div class="space-y-4" id="options-${key}">
                                    ${optionsHTML}
                                </div>
                            </div>
                            
                            ${isDone ? `
                                <div class="mt-8 space-y-4 animate-fade-in">
                                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-xl border border-green-200">
                                        <h5 class="font-bold text-green-800 mb-2 flex items-center gap-2">
                                            <i data-lucide="star"></i> ${T.realExample}
                                        </h5>
                                        <p class="text-gray-700">${L.realExample}</p>
                                    </div>
                                    <div class="bg-gradient-to-r from-purple-50 to-violet-50 p-4 rounded-xl border border-purple-200">
                                        <h5 class="font-bold text-purple-800 mb-2 flex items-center gap-2">
                                            <i data-lucide="zap"></i> ${T.extraTip}
                                        </h5>
                                        <p class="text-gray-700">${L.extra}</p>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="bg-gradient-to-br from-gray-100 to-gray-50 rounded-2xl p-4 min-h-[400px] flex flex-col relative overflow-hidden border-2 border-gray-300 shadow-inner">
                            <div class="bg-white text-sm px-4 py-2 rounded-t-xl flex justify-between items-center text-gray-500 mb-4">
                                <span class="font-bold">${C.type === 'excel' ? 'ðŸ“Š Excel Simulator' : 'ðŸ“ˆ Chart Builder'}</span>
                                <div class="flex gap-1">
                                    <div class="w-3 h-3 rounded-full bg-red-400"></div>
                                    <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                                    <div class="w-3 h-3 rounded-full bg-green-400"></div>
                                </div>
                            </div>
                            <div id="visual-${key}" class="flex-grow bg-white relative p-4 rounded-lg flex items-center justify-center">
                                <div id="placeholder-${key}" class="text-center text-gray-400 ${isDone?'hidden':''}">
                                    <i data-lucide="layout-grid" class="w-16 h-16 mx-auto mb-4 opacity-50 animate-pulse"></i>
                                    <p class="text-lg">${T.placeholder}</p>
                                </div>
                                ${C.type === 'excel' ? `<div id="excel-content-${key}" class="w-full h-full hidden"></div>` : `<canvas id="canvas-${key}" class="hidden w-full h-full chart-hover"></canvas>`}
                            </div>
                            ${C.type === 'chart' ? `
                                <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                                    <div class="text-xs text-gray-500 mb-2">Ù…Ù„Ø®Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</div>
                                    <div class="flex gap-2">
                                        ${L.dataLabels.map((label, i) => `
                                            <div class="flex-1 text-center p-2 rounded bg-white">
                                                <div class="font-bold">${label}</div>
                                                <div class="text-x-primary font-bold">${C.data.d[i]}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div id="actions-${key}" class="flex justify-between items-center ${isDone?'':'hidden'} animate-fade-in">
                        <div class="flex gap-3">
                            <button onclick="showHint('${key}')" class="px-4 py-2 bg-gray-100 rounded-lg flex items-center gap-2 hover:bg-gray-200">
                                <i data-lucide="help-circle"></i> Ù…Ø³Ø§Ø¹Ø¯Ø©
                            </button>
                            <button onclick="practiceMore('${key}')" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg flex items-center gap-2 hover:bg-blue-200">
                                <i data-lucide="repeat"></i> ØªØ¯Ø±Ø¨ Ø£ÙƒØ«Ø±
                            </button>
                        </div>
                        <div class="flex gap-4">
                            <button id="verify-${key}" onclick="verify('${key}')" class="bg-gradient-to-r from-x-secondary to-yellow-400 text-gray-900 px-8 py-4 rounded-xl font-bold flex gap-2 shadow-lg hover:scale-105 transition">
                                ${T.check} <i data-lucide="check-square"></i>
                            </button>
                            <button id="next-${key}" onclick="nextLesson('${key}')" class="hidden bg-gradient-to-r from-x-primary to-green-600 text-white px-8 py-4 rounded-xl font-bold gap-2 shadow-lg hover:scale-105 transition animate-pulse-glow">
                                ${T.next} <i data-lucide="${appState.lang==='ar'?'arrow-left':'arrow-right'}"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        let currentChart = null;

        function selectOption(key, optId) {
            appState.tempSelection = optId;
            const config = lessonsConfig[key];
            const isExcel = config.type === 'excel';
            const placeholder = document.getElementById(`placeholder-${key}`);
            
            // UI Reset
            document.querySelectorAll(`#options-${key} button`).forEach(b => {
                b.classList.remove('ring-4', 'ring-x-primary', 'bg-blue-50', 'scale-105');
            });
            
            const selectedBtn = document.getElementById(`btn-${optId}`);
            selectedBtn.classList.add('ring-4', 'ring-x-primary', 'bg-blue-50', 'scale-105');
            
            if(!appState.completedSections.has(key)) {
                document.getElementById(`actions-${key}`).classList.remove('hidden');
                document.getElementById(`actions-${key}`).classList.add('flex');
                document.getElementById(`verify-${key}`).classList.remove('hidden');
            }

            // Visual Rendering
            placeholder.classList.add('hidden');
            
            if (isExcel) {
                const isCorrect = optId === config.correct;
                const exDiv = document.getElementById(`excel-content-${key}`);
                exDiv.classList.remove('hidden');
                renderExcelGrid(key, config.visual, isCorrect);
            } else {
                const canvas = document.getElementById(`canvas-${key}`);
                canvas.classList.remove('hidden');
                if(currentChart) currentChart.destroy();
                
                const labels = t[appState.lang].lessons[key].dataLabels; 
                const dataValues = config.data.d;

                const backgroundColor = optId === 'pie' || optId === 'radar' 
                    ? ['#107c41', '#fbbf24', '#099999', '#ef4444', '#3b82f6']
                    : '#107c41';

                const cData = { 
                    labels: labels, 
                    datasets: [{
                        label: 'Data',
                        data: dataValues,
                        backgroundColor: backgroundColor,
                        borderColor: '#fbbf24',
                        borderWidth: 3,
                        tension: 0.2,
                        fill: config.visual === 'area',
                        hoverBackgroundColor: '#fbbf24'
                    }]
                };
                
                const chartType = chartConfig[optId] ? chartConfig[optId].type : 'bar';
                const ctx = canvas.getContext('2d');
                currentChart = new Chart(ctx, { 
                    type: chartType, 
                    data: cData, 
                    options: { 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0,0,0,0.8)',
                                titleColor: '#fbbf24',
                                bodyColor: 'white'
                            }
                        },
                        animation: {
                            duration: 1000,
                            easing: 'easeOutQuart'
                        }
                    } 
                });
            }
        }

        function renderExcelGrid(key, type, isCorrect) {
            const el = document.getElementById(`excel-content-${key}`);
            const Sim = t[appState.lang].excelSim;
            let content = '';
            
            const tabs = (active) => `
                <div class="flex mt-4 border-t-2 bg-gray-200 pt-2 overflow-x-auto rounded-b-lg">
                    ${['Jan','Feb','Mar'].map((t, i) => `
                        <div class="px-4 py-2 text-sm rounded-t-lg mx-1 flex items-center gap-2 
                            ${active ? 'bg-gradient-to-b from-white to-gray-100 text-excel-green border-t-4 border-excel-green shadow' 
                                     : 'bg-gray-300 text-gray-500 hover:bg-gray-400'}">
                            <i data-lucide="sheet" class="w-4 h-4"></i>
                            ${t}
                            ${active && i===0 ? '<span class="text-xs bg-x-primary text-white px-2 py-1 rounded-full">Ù†Ø´Ø·</span>' : ''}
                        </div>
                    `).join('')}
                </div>`;
            
            const cell = (val, highlight) => `
                <td class="border-2 border-gray-300 p-3 text-center transition-all duration-300
                    ${highlight ? 'bg-gradient-to-br from-yellow-100 to-amber-100 text-red-600 font-bold animate-pulse' 
                               : 'hover:bg-gray-50'}">
                    ${val}
                </td>`;

            if(type === 'grouping') {
                content = `
                    <div class="mb-4 p-3 bg-gradient-to-r from-gray-100 to-gray-50 rounded-lg border">
                        <div class="font-mono text-sm mb-1">Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù†Ø´Ø·Ø©:</div>
                        <div class="font-bold text-lg text-excel-green ${isCorrect ? 'animate-pulse-glow' : ''}">
                            Sum(${isCorrect ? 'Jan:Mar!C1:C17' : 'Jan!C1:C17'})
                        </div>
                    </div>
                    <table class="w-full text-sm border-2 border-gray-300 rounded-lg overflow-hidden shadow">
                        <thead class="bg-gradient-to-r from-gray-200 to-gray-300">
                            <tr><th class="p-3"></th><th class="p-3">${Sim.item}</th><th class="p-3">${Sim.qty}</th><th class="p-3">${Sim.sales}</th></tr>
                        </thead>
                        <tbody>
                            ${Array.from({length: 3}, (_, i) => `
                                <tr class="${i%2===0?'bg-gray-50':'bg-white'}">
                                    <td class="p-3 font-bold">${i+1}</td>
                                    <td class="p-3">Ù…Ù†ØªØ¬ ${i+1}</td>
                                    <td class="p-3">${(i+1)*10}</td>
                                    <td class="p-3">${(i+1)*100}</td>
                                </tr>
                            `).join('')}
                            <tr class="bg-gradient-to-r from-green-50 to-emerald-50">
                                <td class="p-3 font-bold">18</td>
                                <td class="p-3 font-bold">${Sim.total}</td>
                                <td class="p-3">-</td>
                                ${cell(isCorrect ? 'Sum(Jan:Mar!C1:C17)' : 'Sum(Jan!C1:C17)', false)}
                            </tr>
                        </tbody>
                    </table>
                    ${!isCorrect ? `
                        <div class="absolute inset-4 flex items-center justify-center bg-red-100/90 rounded-xl backdrop-blur-sm">
                            <div class="text-center p-6">
                                <i data-lucide="alert-triangle" class="w-12 h-12 text-red-500 mx-auto mb-4"></i>
                                <div class="text-red-700 font-bold text-lg">${Sim.editWarn}</div>
                                <div class="text-red-600 text-sm mt-2">Ø£Ù†Øª ØªØ¹Ø¯Ù„ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·!</div>
                            </div>
                        </div>
                    ` : `
                        <div class="mt-4 p-3 bg-green-50 rounded-lg border border-green-200">
                            <div class="flex items-center gap-2 text-green-700">
                                <i data-lucide="check-circle" class="w-5 h-5"></i>
                                <span class="font-bold">${Sim.multiSelect}</span>
                            </div>
                        </div>
                    `}
                    ${tabs(isCorrect)}
                `;
            } else if (type === 'formatting') {
                content = `
                    <table class="w-full text-sm border-2 ${isCorrect?'border-blue-500 shadow-lg':'border-gray-300'} rounded-lg overflow-hidden">
                        <thead class="${isCorrect?'bg-gradient-to-r from-blue-100 to-cyan-100 text-blue-800':'bg-gray-200'}">
                            <tr><th class="p-3">#</th><th class="p-3">${Sim.item}</th><th class="p-3">${Sim.sales}</th><th class="p-3">${Sim.qty}</th></tr>
                        </thead>
                        <tbody>
                            ${Array.from({length: 5}, (_, i) => `
                                <tr class="${i%2===0?'bg-gray-50':'bg-white'} ${isCorrect?'hover:bg-blue-50':''}">
                                    <td class="p-3 ${isCorrect?'font-bold text-blue-600':''}">${i+1}</td>
                                    <td class="p-3">Ø¹Ù†ØµØ± ${i+1}</td>
                                    <td class="p-3 ${isCorrect?'border-l-2 border-r-2 border-blue-300':''}">$${(i+1)*250}</td>
                                    <td class="p-3">${(i+1)*5}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    ${!isCorrect ? `
                        <div class="absolute inset-4 flex items-center justify-center bg-gray-100/90 rounded-xl backdrop-blur-sm">
                            <div class="text-center p-6">
                                <i data-lucide="slash" class="w-12 h-12 text-gray-500 mx-auto mb-4"></i>
                                <div class="text-gray-700 font-bold text-lg">${Sim.noFormat}</div>
                                <div class="text-gray-600 text-sm mt-2">ÙƒÙ„ ØµÙØ­Ø© Ø¨ØªÙ†Ø³ÙŠÙ‚ Ù…Ø®ØªÙ„Ù</div>
                            </div>
                        </div>
                    ` : `
                        <div class="mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="flex items-center gap-2 text-blue-700">
                                <i data-lucide="palette" class="w-5 h-5"></i>
                                <span class="font-bold">ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª</span>
                            </div>
                        </div>
                    `}
                    ${tabs(isCorrect)}
                `;
            } else if (type === '3dsum') {
                const sum = isCorrect ? 3850 : '########';
                content = `
                    <div class="flex flex-col items-center justify-center h-full gap-6">
                        <div class="text-center">
                            <div class="text-sm text-gray-500 mb-2">Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</div>
                            <div class="font-mono text-lg bg-gray-100 p-3 rounded-lg ${isCorrect?'border-2 border-green-500':''}">
                                ${isCorrect ? 'Sum(Jan:Mar!C18)' : '=Jan!C18+Feb!C18+Mar!C18'}
                            </div>
                        </div>
                        <div class="bg-gradient-to-br ${isCorrect?'from-green-50 to-emerald-50 border-green-200':'from-gray-100 to-gray-200 border-gray-300'} 
                              p-6 rounded-2xl border-2 text-center shadow-lg w-64 transition-all duration-500 ${isCorrect?'scale-110':''}">
                            <div class="text-sm text-gray-500 mb-1">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø¹Ø¨Ø± 3 Ø£Ø´Ù‡Ø±</div>
                            <div class="text-4xl font-black ${isCorrect?'text-excel-green animate-tada':'text-gray-400'}">${sum}</div>
                            <div class="text-xs text-gray-400 mt-2">Ù…Ø¨ÙŠØ¹Ø§Øª Q1</div>
                        </div>
                        ${isCorrect ? `
                            <div class="mt-4 p-3 bg-green-50 rounded-lg">
                                <div class="flex items-center gap-2 text-green-700">
                                    <i data-lucide="zap" class="w-5 h-5"></i>
                                    <span>Ù…Ø¹Ø§Ø¯Ù„Ø© ÙˆØ­Ø¯Ø© Ù„Ù€ 3 ØµÙØ­Ø§Øª!</span>
                                </div>
                            </div>
                        ` : `
                            <div class="mt-4 p-3 bg-red-50 rounded-lg">
                                <div class="flex items-center gap-2 text-red-700">
                                    <i data-lucide="alert-circle" class="w-5 h-5"></i>
                                    <span>Ù…Ø¹Ø§Ø¯Ù„Ø© Ø·ÙˆÙŠÙ„Ø© ÙˆØ¹Ø±Ø¶Ø© Ù„Ù„Ø®Ø·Ø£</span>
                                </div>
                            </div>
                        `}
                    </div>
                `;
            } else if (type === 'ungroup') {
                const statusClass = isCorrect ? 'from-green-50 to-emerald-50 text-green-800 border-green-200' 
                                            : 'from-red-50 to-rose-50 text-red-800 border-red-200';
                const statusIcon = isCorrect ? 'check-circle' : 'alert-triangle';
                const statusText = isCorrect ? Sim.safe : Sim.warn;
                
                content = `
                    <div class="h-full flex flex-col">
                        <div class="flex-1 bg-white rounded-lg border-2 border-gray-300 p-4 mb-4 flex items-center justify-center">
                            <div class="text-center">
                                <i data-lucide="database" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                                <div class="text-gray-600">Ø¨ÙŠØ§Ù†Ø§Øª ØµÙØ­Ø© ${isCorrect ? 'Jan' : 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª'}</div>
                                <div class="text-2xl font-bold mt-2 ${isCorrect?'text-excel-green':'text-red-500'}">
                                    ${isCorrect ? 'Ù…Ø­ÙÙˆØ¸Ø© âœ“' : 'Ù…Ø¹Ø±Ø¶Ø© Ù„Ù„Ø®Ø·Ø±!'}
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r ${statusClass} p-4 rounded-lg border-2 text-center animate-pulse">
                            <i data-lucide="${statusIcon}" class="w-8 h-8 mx-auto mb-2"></i>
                            <div class="font-bold text-lg">${statusText}</div>
                            <div class="text-sm mt-1">${isCorrect ? Sim.groupMode : Sim.multiSelect}</div>
                        </div>
                        
                        ${tabs(!isCorrect)}
                    </div>
                `;
            }
            el.innerHTML = content;
            lucide.createIcons();
        }

        function verify(key) {
            const opt = appState.tempSelection;
            if(!opt) {
                showToast(t[appState.lang].common.wrong, 'error');
                return;
            }
            
            const config = lessonsConfig[key];
            const btn = document.getElementById(`btn-${opt}`);
            
            if(opt === config.correct) {
                // ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‚Ø¯ Ø¸Ù‡Ø±Øª Ù…Ù† Ù‚Ø¨Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³
                if (!appState.lessonCompletedMessages.has(key)) {
                    showToast(t[appState.lang].common.correct, 'success');
                    appState.lessonCompletedMessages.add(key);
                }
                
                appState.completedSections.add(key);
                
                // Ø¥Ø¶Ø§ÙØ© Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
                const excelLessons = ['grouping', 'formatting', 'formulas', 'safety'];
                const chartLessons = ['comparison', 'trends', 'proportions', 'relationships'];
                
                if (excelLessons.every(l => appState.completedSections.has(l))) {
                    addAchievement('excelMaster');
                }
                
                if (chartLessons.every(l => appState.completedSections.has(l))) {
                    addAchievement('chartWizard');
                }
                
                btn.classList.replace('ring-x-primary', 'ring-excel-green');
                btn.classList.replace('bg-blue-50', 'bg-green-50');
                
                document.getElementById(`verify-${key}`).classList.add('hidden');
                document.getElementById(`next-${key}`).classList.remove('hidden');
                document.getElementById(`next-${key}`).classList.add('flex');
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø«Ø§Ù„ ÙˆØ§Ù‚Ø¹ÙŠ ÙˆØªÙ„Ù…ÙŠØ­Ø§Øª
                setTimeout(() => {
                    const lessonContainer = document.getElementById(`content-container`);
                    const extraContent = document.createElement('div');
                    extraContent.className = 'animate-fade-in mt-6';
                    extraContent.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-xl border border-green-200">
                                <h5 class="font-bold text-green-800 mb-2 flex items-center gap-2">
                                    <i data-lucide="briefcase"></i> Ù…Ø«Ø§Ù„ ÙˆØ§Ù‚Ø¹ÙŠ
                                </h5>
                                <p class="text-sm text-gray-700">${t[appState.lang].lessons[key].realExample}</p>
                            </div>
                            <div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-4 rounded-xl border border-blue-200">
                                <h5 class="font-bold text-blue-800 mb-2 flex items-center gap-2">
                                    <i data-lucide="zap"></i> ØªÙ„Ù…ÙŠØ­ Ø§Ø­ØªØ±Ø§ÙÙŠ
                                </h5>
                                <p class="text-sm text-gray-700">${t[appState.lang].lessons[key].extra}</p>
                            </div>
                        </div>
                    `;
                    lessonContainer.querySelector(`#actions-${key}`).before(extraContent);
                }, 500);
                
                // Ø£Ù„Ø¹Ø§Ø¨ Ù†Ø§Ø±ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©
                const colors = ['#107c41', '#fbbf24', '#099999', '#ffffff'];
                confetti({
                    particleCount: 100,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: colors
                });
                confetti({
                    particleCount: 100,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: colors
                });
                
                setTimeout(() => {
                    confetti({
                        particleCount: 50,
                        spread: 100,
                        decay: 0.91,
                        scalar: 1.2,
                        colors: colors
                    });
                }, 300);
                
                updateProgress();
                renderNav();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ XP
                appState.xp += 100;
                if (document.getElementById('xp-value')) {
                    document.getElementById('xp-value').textContent = appState.xp;
                }
                
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø³Ø±Ø¹Ø©
                if (!appState.lastActivity) {
                    appState.lastActivity = Date.now();
                } else {
                    const timeDiff = (Date.now() - appState.lastActivity) / (1000 * 60);
                    if (timeDiff < 5) {
                        appState.streak++;
                        if (appState.streak >= 3) {
                            addAchievement('speedDemon');
                        }
                    }
                    appState.lastActivity = Date.now();
                }
                
            } else {
                showToast(t[appState.lang].common.wrong, 'error');
                btn.classList.replace('ring-x-primary', 'ring-red-500');
                btn.classList.replace('bg-blue-50', 'bg-red-50');
                btn.classList.add('animate-shake');
                setTimeout(() => btn.classList.remove('animate-shake'), 500);
                
                // Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙ Ù„Ù„Ø´Ø§Ø´Ø©
                document.getElementById('content-container').classList.add('animate-shake');
                setTimeout(() => {
                    document.getElementById('content-container').classList.remove('animate-shake');
                }, 500);
            }
        }

        function nextLesson(curr) {
            const keys = ['hero', ...Object.keys(lessonsConfig), 'quiz'];
            const idx = keys.indexOf(curr);
            if(idx < keys.length-1) {
                renderContent(keys[idx+1]);
            }
        }

        function showHint(key) {
            const hints = {
                'grouping': 'Ø§Ø¶ØºØ· Ctrl ÙˆØ§Ø³ØªÙ…Ø± Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨',
                'formatting': 'Ø§Ù†Ù‚Ø± Ø¨Ø²Ø± Ø§Ù„Ù…Ø§ÙˆØ³ Ø§Ù„Ø£ÙŠÙ…Ù† Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨ ÙˆØ§Ø®ØªØ± Select All Sheets',
                'formulas': 'Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ† : Ù„Ù„Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª',
                'safety': 'Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ [Group] ÙÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†',
                'comparison': 'Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ Ù‡Ùˆ Ø§Ù„Ø£ÙØ¶Ù„ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¨ØµØ±ÙŠØ©',
                'trends': 'Ø§Ù„Ø®Ø· ÙŠØ¸Ù‡Ø± Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø¹Ø¨Ø± Ø§Ù„Ø²Ù…Ù†',
                'proportions': 'Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© ØªØ¸Ù‡Ø± Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©',
                'relationships': 'Ø§Ù„Ø±Ø§Ø¯Ø§Ø± ÙŠÙ‚ÙŠÙ… Ø¹Ø¯Ø© Ù…Ø¹Ø§ÙŠÙŠØ± ÙÙŠ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©'
            };
            
            showToast(hints[key], 'success');
        }

        function practiceMore(key) {
            const practices = {
                'grouping': 'Ø¬Ø±Ø¨: Ø£Ù†Ø´Ø¦ 5 ØµÙØ­Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ¬Ø±Ø¨ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ',
                'formatting': 'ØªØ­Ø¯ÙŠ: ÙˆØ­Ø¯ ØªÙ†Ø³ÙŠÙ‚ 10 ØµÙØ­Ø§Øª Ù…Ø®ØªÙ„ÙØ© ÙÙŠ Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†',
                'formulas': 'ØªÙ…Ø±ÙŠÙ†: Ø£Ù†Ø´Ø¦ Ù…Ø¹Ø§Ø¯Ù„Ø© 3D ØªØ­Ø³Ø¨ Ø§Ù„Ù…ØªÙˆØ³Ø· Ù„Ù€ 6 ØµÙØ­Ø§Øª',
                'safety': 'Ø§Ø®ØªØ¨Ø§Ø±: ÙƒÙ… Ù…Ø±Ø© ØªÙ†Ø³Ù‰ Ungroup ÙÙŠ Ø§Ù„ÙŠÙˆÙ…ØŸ Ø±Ø§Ù‚Ø¨ Ù†ÙØ³Ùƒ!',
                'comparison': 'ØªØ·Ø¨ÙŠÙ‚: Ù‚Ø§Ø±Ù† Ù…Ø¨ÙŠØ¹Ø§Øª 5 Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø±Ø³Ù… ÙˆØ§Ø­Ø¯',
                'trends': 'ØªØ­Ù„ÙŠÙ„: Ø§Ø±Ø³Ù… Ø§ØªØ¬Ø§Ù‡ Ø£Ø³Ø¹Ø§Ø± 12 Ø´Ù‡Ø±Ø§Ù‹',
                'proportions': 'ØªÙ…Ø«ÙŠÙ„: Ù…Ø«Ù„ Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ø±ÙƒØ© Ø¨Ù†Ø³Ø¨ Ù…Ø¦ÙˆÙŠØ©',
                'relationships': 'ØªÙ‚ÙŠÙŠÙ…: Ù‚ÙŠÙ… Ù†ÙØ³Ùƒ ÙÙŠ 6 Ù…Ù‡Ø§Ø±Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ø§Ø¯Ø§Ø±'
            };
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-fade-in';
            modal.innerHTML = `
                <div class="bg-white p-8 rounded-2xl max-w-md w-full mx-4 animate-zoom-in">
                    <h3 class="text-2xl font-bold text-x-primary mb-4 flex items-center gap-2">
                        <i data-lucide="dumbbell"></i> ØªÙ…Ø±ÙŠÙ† ØªØ·Ø¨ÙŠÙ‚ÙŠ
                    </h3>
                    <p class="text-gray-700 mb-6">${practices[key]}</p>
                    <div class="flex gap-4">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-gray-100 py-3 rounded-xl font-bold">
                            ÙÙ‡Ù…Øª
                        </button>
                        <button onclick="startPractice('${key}')" class="flex-1 bg-x-primary text-white py-3 rounded-xl font-bold hover:bg-x-primary-dark">
                            Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªÙ…Ø±ÙŠÙ†
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            lucide.createIcons();
        }

        function startPractice(key) {
            showToast('ØªÙ… Ø¨Ø¯Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ†!', 'success');
            document.querySelector('.fixed').remove();
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ†
            setTimeout(() => {
                showToast('Ù…Ù…ØªØ§Ø²! Ø£ÙƒÙ…Ù„Øª Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­ ðŸŽ¯', 'success');
                confetti({
                    particleCount: 30,
                    spread: 60,
                    origin: { y: 0.6 }
                });
            }, 2000);
        }

        function showLeaderboard() {
            document.getElementById('leaderboard-modal').style.display = 'flex';
            updateLeaderboard();
        }

        function updateLeaderboard() {
            const leaderboard = [
                { name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', score: 950, rank: 1 },
                { name: 'Ø³Ø§Ø±Ø© Ø¹Ù„ÙŠ', score: 890, rank: 2 },
                { name: 'Ø®Ø§Ù„Ø¯ Ø­Ø³Ù†', score: 850, rank: 3 },
                { name: 'ÙØ§Ø·Ù…Ø© Ø¹Ù…Ø±', score: 820, rank: 4 },
                { name: 'Ù…Ø­Ù…Ø¯ ÙƒØ±ÙŠÙ…', score: 800, rank: 5 }
            ];
            
            const list = document.getElementById('leaderboard-list');
            list.innerHTML = leaderboard.map(player => `
                <div class="flex items-center justify-between p-3 rounded-lg ${player.rank <= 3 ? `rank-${player.rank}` : 'bg-gray-50'}">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center ${player.rank <= 3 ? 'bg-white/50' : 'bg-gray-200'}">
                            ${player.rank <= 3 ? ['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰'][player.rank-1] : player.rank}
                        </div>
                        <div>
                            <div class="font-bold">${player.name}</div>
                            <div class="text-xs text-gray-500">${player.score} Ù†Ù‚Ø·Ø©</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="sparkline" style="width: ${(player.score/1000)*100}%"></div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('user-rank').textContent = `#${Math.floor(Math.random() * 20) + 6}`;
            document.getElementById('user-score').querySelector('p:last-child').textContent = appState.xp;
        }

        function renderQuiz() {
            const Q = t[appState.lang].quiz;
            return `
                <div class="max-w-3xl mx-auto py-8">
                    <div class="text-center mb-8">
                        <h2 class="text-4xl font-black mb-2 text-x-primary">${Q.t}</h2>
                        <p class="text-gray-600">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ø±ÙØªÙƒ ÙÙŠ Excel ÙˆØ§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©</p>
                    </div>
                    
                    <div class="space-y-6">
                        ${Q.qs.map((q, i) => `
                            <div class="bg-gradient-to-br from-white to-gray-50 p-6 rounded-2xl border-2 border-gray-200 shadow-lg hover:shadow-xl transition-shadow">
                                <div class="flex items-start gap-4 mb-4">
                                    <div class="w-10 h-10 rounded-full bg-x-primary text-white flex items-center justify-center font-bold text-lg">${i+1}</div>
                                    <p class="font-bold text-lg text-gray-800 flex-1">${q.t}</p>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    ${q.o.map((opt, idx) => `
                                        <label class="bg-gray-100 p-4 rounded-xl border-2 border-transparent hover:border-x-primary cursor-pointer transition-all hover:scale-[1.02] flex items-center gap-3">
                                            <input type="radio" name="q${i}" value="${opt}" data-index="${i}" 
                                                   class="w-5 h-5 accent-x-primary">
                                            <div class="flex-1">
                                                <div class="font-bold text-gray-800">${opt}</div>
                                            </div>
                                            <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
                                                ${String.fromCharCode(65 + idx)}
                                            </div>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-12 text-center">
                        <button onclick="submitQuiz()" class="bg-gradient-to-r from-x-secondary to-yellow-400 text-gray-900 font-bold py-4 px-16 rounded-xl shadow-lg hover:scale-105 transition text-lg flex items-center gap-3 mx-auto">
                            <i data-lucide="send"></i> ${t[appState.lang].common.submit}
                        </button>
                        <p class="text-gray-500 mt-4">4 Ø£Ø³Ø¦Ù„Ø© - ØªØ­ØªØ§Ø¬ 3 Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø© Ù„Ù„Ù†Ø¬Ø§Ø­</p>
                    </div>
                </div>
            `;
        }

        function submitQuiz() {
            let score = 0;
            const answers = [
                'Ctrl', // Ø§Ø®ØªÙŠØ§Ø± ØµÙØ­Ø§Øª Ù…ØªÙØ±Ù‚Ø©
                'Sum(Jan:Mar!A1)', // Ù…Ø¹Ø§Ø¯Ù„Ø© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
                'Pie', // Ù„Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
                'Bar (Horizontal)' // Ù„Ø£Ø³Ù…Ø§Ø¡ Ø·ÙˆÙŠÙ„Ø©
            ];
            
            for(let i = 0; i < 4; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                if(selected) {
                    // ØªØ­Ù‚Ù‚ Ø¨Ø³ÙŠØ· Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
                    if (selected.value.includes(answers[i]) || 
                        (i === 0 && selected.value === 'Ctrl') ||
                        (i === 1 && selected.value.includes('Jan:Mar')) ||
                        (i === 2 && selected.value === 'Pie') ||
                        (i === 3 && selected.value.includes('Bar'))) {
                        score++;
                    }
                }
            }
            
            const container = document.getElementById('content-container');
            if(score >= 3) {
                appState.completedSections.add('quiz');
                updateProgress();
                
                // Ø£Ù„Ø¹Ø§Ø¨ Ù†Ø§Ø±ÙŠØ© Ù…ÙƒØ«ÙØ©
                const end = Date.now() + 3 * 1000;
                const colors = ['#107c41', '#fbbf24', '#099999'];
                
                (function frame() {
                    confetti({
                        particleCount: 5,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 },
                        colors: colors
                    });
                    confetti({
                        particleCount: 5,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 },
                        colors: colors
                    });
                    
                    if (Date.now() < end) {
                        requestAnimationFrame(frame);
                    }
                }());
                
                showToast(`ðŸŽŠ Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${score}/4 - Ù†Ø¬Ø­Øª Ø¨Ø§Ù…ØªÙŠØ§Ø²!`, 'success');
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ù†ØªÙŠØ¬Ø© Ù…ÙØµÙ„Ø©
                setTimeout(() => {
                    container.innerHTML += `
                        <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-fade-in">
                            <div class="bg-white p-10 rounded-2xl max-w-lg w-full mx-4 text-center animate-zoom-in">
                                <div class="w-24 h-24 rounded-full bg-gradient-to-r from-gold to-yellow-400 flex items-center justify-center mx-auto mb-6">
                                    <i data-lucide="trophy" class="w-12 h-12 text-white"></i>
                                </div>
                                <h3 class="text-3xl font-black text-x-primary mb-2">ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ðŸŽ‰</h3>
                                <p class="text-gray-600 mb-6">Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­</p>
                                <div class="text-center mb-8">
                                    <div class="text-6xl font-black text-x-secondary mb-2">${score}/4</div>
                                    <div class="text-gray-500">Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©</div>
                                </div>
                                <div class="flex gap-4">
                                    <button onclick="this.closest('.fixed').remove(); renderContent('hero')" 
                                            class="flex-1 bg-gray-100 py-3 rounded-xl font-bold">
                                        Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                                    </button>
                                    <button onclick="document.getElementById('certificate-modal').style.display = 'flex'; this.closest('.fixed').remove()" 
                                            class="flex-1 bg-x-primary text-white py-3 rounded-xl font-bold hover:bg-x-primary-dark">
                                        Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© <i data-lucide="award"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    lucide.createIcons();
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
                    if (score === 4) {
                        addAchievement('perfectScore');
                    }
                }, 2000);
                
            } else {
                showToast(`Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${score}/4 - ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ${3-score} Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø© Ø¥Ø¶Ø§ÙÙŠØ©`, 'error');
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
                setTimeout(() => {
                    const correctAnswers = document.createElement('div');
                    correctAnswers.className = 'mt-6 p-6 bg-gradient-to-r from-red-50 to-rose-50 rounded-2xl border border-red-200 animate-fade-in';
                    correctAnswers.innerHTML = `
                        <h4 class="font-bold text-red-800 mb-4 flex items-center gap-2">
                            <i data-lucide="lightbulb"></i> Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:
                        </h4>
                        <ul class="space-y-2 text-gray-700">
                            <li><span class="font-bold">1.</span> Ctrl (Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªÙØ±Ù‚Ø©)</li>
                            <li><span class="font-bold">2.</span> Sum(Jan:Mar!A1) (Ù…Ø¹Ø§Ø¯Ù„Ø© 3D)</li>
                            <li><span class="font-bold">3.</span> Pie (Ù„Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©)</li>
                            <li><span class="font-bold">4.</span> Bar (Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©)</li>
                        </ul>
                        <button onclick="renderContent('quiz')" class="mt-4 bg-red-100 text-red-700 px-4 py-2 rounded-lg font-bold hover:bg-red-200">
                            <i data-lucide="refresh-ccw"></i> Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                        </button>
                    `;
                    container.appendChild(correctAnswers);
                    lucide.createIcons();
                }, 1000);
            }
        }

        function showToast(m, type) {
            const el = document.createElement('div'); 
            el.className = `toast ${type}`;
            el.innerHTML = type === 'success' 
                ? `<i data-lucide="check-circle" class="w-5 h-5 text-green-500"></i> ${m}` 
                : `<i data-lucide="x-circle" class="w-5 h-5 text-red-500"></i> ${m}`;
            
            const container = document.getElementById('toast-container');
            container.appendChild(el); 
            lucide.createIcons();
            
            setTimeout(() => el.classList.add('show'), 10);
            setTimeout(() => {
                el.classList.remove('show');
                setTimeout(() => el.remove(), 400);
            }, 3000);
        }

function downloadCertificate() {
            // 1. Ø£Ø®Ø° Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø£ØµÙ„ÙŠ
            const element = document.getElementById('certificate-content');
            
            // 2. Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ù†Ù‡ (Clone) Ø¹Ø´Ø§Ù† Ù†ØªØ­ÙƒÙ… ÙÙŠÙ‡Ø§ Ø¨Ø±Ø§Ø­ØªÙ†Ø§ Ø¨Ø¯ÙˆÙ† Ù…Ø§ Ù†Ø®Ø±Ø¨ Ø§Ù„Ø´Ø§Ø´Ø©
            const clone = element.cloneNode(true);

            // 3. Ø¶Ø¨Ø· ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù†Ø³Ø®Ø© Ù„ØªÙƒÙˆÙ† Ø¸Ø§Ù‡Ø±Ø© Ù„Ù„ÙƒÙˆØ¯ ÙÙ‚Ø· (Ø®Ø§Ø±Ø¬ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ø§Ø´Ø©)
            clone.style.display = 'block';
            clone.style.position = 'absolute';
            clone.style.top = '-10000px'; // Ù†Ø¨Ø¹Ø«Ù‡Ø§ Ù…ÙƒØ§Ù† Ø¨Ø¹ÙŠØ¯ Ù…Ø§ Ø­Ø¯Ø§ ÙŠØ´ÙˆÙÙ‡
            clone.style.left = '-10000px';
            clone.style.width = '900px';  // Ø¹Ø±Ø¶ Ø«Ø§Ø¨Øª Ø¹Ø´Ø§Ù† Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ÙŠØ·Ù„Ø¹ Ù…Ø±ØªØ¨
            clone.style.height = 'auto';
            clone.style.background = '#ffffff'; // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡
            clone.style.zIndex = '-1';
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù† Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØ·Ù„Ø¹ Ø´ÙƒÙ„Ù‡Ø§ Ù…Ø´ÙˆÙ‡ Ø¨Ø§Ù„ØµÙˆØ±Ø©
            clone.classList.remove('animate-zoom-in', 'animate-float');
            
            // 4. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø³Ø®Ø© Ù„Ù„ØµÙØ­Ø© Ù…Ø¤Ù‚ØªØ§Ù‹
            document.body.appendChild(clone);

            // 5. Ø§Ù„ØªØµÙˆÙŠØ±
            html2canvas(clone, {
                scale: 2, // Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©
                useCORS: true, // Ø¹Ø´Ø§Ù† ØµÙˆØ±Ø© Ø§Ù„Ù„ÙˆØ¬Ùˆ ØªØ·Ù„Ø¹
                backgroundColor: '#ffffff',
                allowTaint: true,
                logging: false
            }).then(canvas => {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
                const link = document.createElement('a');
                link.download = `Ø´Ù‡Ø§Ø¯Ø©_${appState.userName || 'Ø§Ù„Ù…ØªØ¯Ø±Ø¨'}.png`;
                link.href = canvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø®Ù„ÙØ§Øª
                document.body.removeChild(link);
                document.body.removeChild(clone);
                
                showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­! ðŸ“„', 'success');
            }).catch(error => {
                console.error('Error:', error);
                if(document.body.contains(clone)) document.body.removeChild(clone);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©', 'error');
            });
        }
        function shareCertificate() {
            if (navigator.share) {
                navigator.share({
                    title: `Ø´Ù‡Ø§Ø¯Ø© ${appState.userName} ÙÙŠ Excel Master Class`,
                    text: `Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø´Ù‡Ø§Ø¯ØªÙŠ ÙÙŠ Ø¥ØªÙ‚Ø§Ù† Excel ÙˆØ§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ù…Ù† X Academy!`,
                    url: window.location.href
                }).then(() => {
                    showToast('ØªÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                });
            } else {
                // Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
                navigator.clipboard.writeText(window.location.href);
                showToast('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©! ðŸ“‹', 'success');
            }
        }
    </script>
</body>
</html>
